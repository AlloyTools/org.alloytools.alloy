/* DO NOT EDIT THIS FILE - it is machine generated */
#include <stdint.h>
#include <jni.h>
#include "repo/lglib.h"
#include "AlloyLingeling.h"
#include <stdio.h>
#include <stdlib.h>


#define NS(name) Java_org_alloytools_solvers_natv_lingeling_Lingeling_ ## name


/*
 * Class:     kodkod_engine_satlab_Lingeling
 * Method:    make
 * Signature: ()J
 */
JNIEXPORT jlong JNICALL NS(make)
  (JNIEnv * env, jclass jc) {
	LGL* lgl = lglinit();
	return ((jlong) lgl);
}

/*
 * Class:     kodkod_engine_satlab_Lingeling
 * Method:    free
 * Signature: (J)V
 */
JNIEXPORT void JNICALL NS(free)
  (JNIEnv * env, jobject obj, jlong lgl) {
	lglrelease((LGL*)lgl);
}

/*
 * Class:     kodkod_engine_satlab_Lingeling
 * Method:    addVariables
 * Signature: (JI)V
 */
JNIEXPORT void JNICALL NS(addVariables)
  (JNIEnv * env, jobject obj, jlong lgl, jint nvars) {
	// ignore calls to addVariables since
	// lingeling dynamically adds variables as they appear in clauses.
	// this means we have to compensate for it in the value_of method
	// and just return false when passed a variable that has not appeared
	// in any clause.
}

/*
 * Class:     kodkod_engine_satlab_Lingeling
 * Method:    addClause
 * Signature: (J[I)Z
 */
JNIEXPORT jboolean JNICALL NS(addClause)
  (JNIEnv * env, jobject obj, jlong lgl, jintArray clause) {
	jsize length = (*env)->GetArrayLength(env, clause);
	jint* buf = (*env)->GetIntArrayElements(env, clause, JNI_FALSE);
	LGL* lglPtr = (LGL*)lgl;
	int i;
	for(i = 0; i < length; i++) {
		int lit = *(buf+i);
		//printf("%d ", lit);
		lgladd (lglPtr, lit);
	}
	//printf("0\n");
	lgladd (lglPtr, 0);
	(*env)->ReleaseIntArrayElements(env, clause, buf, 0);
	return JNI_TRUE;
}

/*
 * Class:     kodkod_engine_satlab_Lingeling
 * Method:    solve
 * Signature: (J)Z
 */
JNIEXPORT jboolean JNICALL NS(solve)
  (JNIEnv * env, jobject obj, jlong lgl) {
	LGL* lglPtr = (LGL*) lgl;
	return lglsat(lglPtr)==10;
}

/*
 * Class:     kodkod_engine_satlab_Lingeling
 * Method:    valueOf
 * Signature: (JI)Z
 */
JNIEXPORT jboolean JNICALL NS(valueOf)
  (JNIEnv * env, jobject obj, jlong lgl, jint var) {
	LGL* lglPtr = (LGL*) lgl;
	if (var <= lglmaxvar(lglPtr))
		return lglderef(lglPtr, var) > 0;
	else
		return JNI_FALSE;
}

